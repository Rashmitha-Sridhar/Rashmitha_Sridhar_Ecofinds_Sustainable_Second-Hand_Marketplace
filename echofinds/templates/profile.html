<!DOCTYPE html>
<html>
<head>
  <title>Profile</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
  <header class="site-nav">
    <div class="container">
      <div class="brand"><img src="{{ url_for('static', filename='logo.jpg') }}" alt="logo">EcoFinds</div>
      <div class="nav-actions">
        <a class="nav-link" href="/dashboard">Dashboard</a>
        <a class="nav-link" href="/my_listings">My Listings</a>
        {% if session.get('user_id') %}
          <a class="nav-link" href="/previous_purchases">Orders</a>
        {% endif %}
        <a class="nav-link" href="/logout">Logout</a>
      </div>
    </div>
  </header>
  <main class="container">
    <div class="auth-card">
      <h2>Edit Profile</h2>
      {% if error %}
        <div class="error">{{ error }}</div>
      {% endif %}
      <form method="POST" enctype="multipart/form-data">
        <div class="form-group">
          <label>Username</label>
          <input type="text" name="username" value="{{ user.username if user else '' }}">
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" name="email" value="{{ user.email if user else '' }}">
        </div>
        <div class="form-group">
          <label>Password</label>
          <input type="password" name="password" value="{{ user.password if user else '' }}">
        </div>
        <div class="form-group">
          <label>Profile Image</label>
          {% if user and user.profile_image %}
            <div style="margin-bottom:.5rem"><img src="{{ url_for('static', filename='uploads/' ~ user.profile_image) }}?v={{ user.profile_image }}" alt="profile" style="height:60px;border-radius:30px"></div>
          {% endif %}
          <input type="file" name="image" accept="image/*">
        </div>
        <button class="btn" type="submit">Save Profile</button>
      </form>
    </div>
  </main>
</body>
</html>
